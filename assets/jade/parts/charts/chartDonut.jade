section.b-chart-donut
  .container
    .b-chart-donut__list
      .b-chart-donut__item
        .b-chart-donut__item-top
          b Lorem ipsum dolor sit amet,
          p consectetur adipiscing elit. Aliquam ipsum orci, gravida sit amet molestie sed, suscipit sed ante.
        .b-chart-donut__item-bottom
          .b-chart-donut__chart(data-result='90.0')
          p.
            Integer hendrerit elit eget fermentum malesuada. Ut sagittis commodo sapien, nec laoreet neque finibus eget.
            In hac habitasse platea dictumst.

      .b-chart-donut__item
        .b-chart-donut__item-top
          b Lorem ipsum dolor sit amet,
          p consectetur adipiscing elit. Aliquam ipsum orci, gravida sit amet molestie sed, suscipit sed ante.
        .b-chart-donut__item-bottom
          .b-chart-donut__chart(data-result='89.9')
          p.
            Integer hendrerit elit eget fermentum malesuada. Ut sagittis commodo sapien, nec laoreet neque finibus eget.
            In hac habitasse platea dictumst.

      .b-chart-donut__item
        .b-chart-donut__item-top
          b Lorem ipsum dolor sit amet,
          p consectetur adipiscing elit. Aliquam ipsum orci, gravida sit amet molestie sed, suscipit sed ante.
        .b-chart-donut__item-bottom
          .b-chart-donut__chart(data-result='88.0')
          p.
            Integer hendrerit elit eget fermentum malesuada. Ut sagittis commodo sapien, nec laoreet neque finibus eget.
            In hac habitasse platea dictumst.

  script.
    $(window).bind('scroll', function () {
      if (!$('.b-chart-donut').hasClass('active')) {
        if ($(window).scrollTop() > $('.b-chart-donut').offset().top - $(window).height() / 1.5) {
          $('.b-chart-donut__chart').each(function () {
            var val = ' ' + $(this).data('result');
            var label = val.replace(".", ",");
            var chart = new Chartist.Pie(this, {
              series: [val],
              labels: [label + '%']
            }, {
              donut: true,
              donutWidth: 17,
              total: 100
            });

            chart.on('draw', function (data) {
              if (data.type === 'slice') {
                var pathLength = data.element._node.getTotalLength();
                data.element.attr({
                  'stroke-dasharray': pathLength + 'px ' + pathLength + 'px'
                });

                var animationDefinition = {
                  'stroke-dashoffset': {
                    id: 'anim' + data.index,
                    dur: 1500,
                    from: -pathLength + 'px',
                    to: '0px',
                    easing: Chartist.Svg.Easing.easeOutQuint,
                    fill: 'freeze'
                  }
                };

                if (data.index !== 0) {
                  animationDefinition['stroke-dashoffset'].begin = 'anim' + (data.index - 1) + '.end';
                }

                data.element.attr({
                  'stroke-dashoffset': -pathLength + 'px'
                });

                data.element.animate(animationDefinition, false);
              }
            });
          })
          $('.b-chart-donut').addClass('active')
        }
      }
    })
